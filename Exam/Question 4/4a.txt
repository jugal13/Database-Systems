CREATE TABLE SUPPLIER (
  Sid INT NOT NULL PRIMARY KEY,
  Sname VARCHAR(16) NOT NULL UNIQUE,
  Address VARCHAR(20) NOT NULL
);

CREATE TABLE PART (
  Pid INT NOT NULL PRIMARY KEY,
  Pname VARCHAR(18) NOT NULL,
  Color VARCHAR(10) NOT NULL,
);

CREATE TABLE SHIPMENT (
  Sid INT NOT NULL REFERENCES SUPPLIER(Sid),
  Pid INT NOT NULL REFERENCES PART(Pid),
  Cost INT NOT NULL,
  PRIMARY KEY (Sid, Pid)
);
 
INSERT INTO SUPPLIER VALUES (1, 'Smith', 'London');
INSERT INTO SUPPLIER VALUES (2, 'Jones', 'Paris');
INSERT INTO SUPPLIER VALUES (3, 'Blake', 'Paris');
INSERT INTO SUPPLIER VALUES (4, 'Clark', 'London');
INSERT INTO SUPPLIER VALUES (5, 'Adams', 'Athens');
  
INSERT INTO PART VALUES (1, 'Nut', 'Red');
INSERT INTO PART VALUES (2, 'Bolt', 'Green');
INSERT INTO PART VALUES (3, 'Screw', 'Blue');
INSERT INTO PART VALUES (4, 'Screw', 'Red');
INSERT INTO PART VALUES (5, 'Cam', 'Blue');
INSERT INTO PART VALUES (6, 'Cog', 'Red');
  
INSERT INTO SHIPMENT VALUES (1, 1, 300);
INSERT INTO SHIPMENT VALUES (1, 2, 200);
INSERT INTO SHIPMENT VALUES (1, 3, 400);
INSERT INTO SHIPMENT VALUES (1, 4, 200);
INSERT INTO SHIPMENT VALUES (1, 5, 100);
INSERT INTO SHIPMENT VALUES (1, 6, 100);
INSERT INTO SHIPMENT VALUES (2, 1, 300);
INSERT INTO SHIPMENT VALUES (2, 2, 400);
INSERT INTO SHIPMENT VALUES (3, 2, 200);
INSERT INTO SHIPMENT VALUES (4, 2, 200);
INSERT INTO SHIPMENT VALUES (4, 4, 300);
INSERT INTO SHIPMENT VALUES (4, 5, 400);
  
-- Find the Sids of suppliers who supply green part

SELECT Sid FROM SUPPLIER WHERE IN (SELECT Sid FROM SHIPMENT WHERE IN (SELECT Pid FROM PART WHERE Color = "Green"));
-- or
SELECT Distinct S.Sid FROM SUPPLIER S, Parts P, SHIPMENT C WHERE C.Sid=S.Sid AND P.Pid=C.Pid AND P.Color like 'Green';

-- For every supplier print the name of the supplier and the total number of parts that he/she supplies.

SELECT S.Sname, COUNT(*) as PartCount FROM SUPPLIER S, SHIPMENT C, PART P WHERE C.Sid = S.Sid and P.Pid = C.Pid GROUP BY S.Sname, S.Sid

-- Update part color supplied by supplier S3 to Yellow
UPDATE PART SET Color='Yellow' WHERE Pid IN (SELECT C.Pid FROM PART P, SUPPLIER S, SHIPMENT C WHERE C.Sid=S.Sid and P.Pid=C.Pid and C.Sid=3);
-- or
UPDATE PART SET Color='Yellow' WHERE Pid IN (SELECT Pid FROM SHIPMENT WHERE IN (SELECT Sid FROM SUPPLIER WHERE Sid=3));