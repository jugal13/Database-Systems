CREATE TABLE CUSTOMER(
  Cno INT,
  Cname VARCHAR(50),
  Ccity VARCHAR(50),
  PRIMARY KEY(Cno)
);
 
CREATE TABLE ORDER1(
  Ono INT,
  Odate DATE,
  Ocno INT,
  Oamt INT, 
  PRIMARY KEY(Ono),
  Foreign KEY(Ocno) REFERENCES CUSTOMER(Cno) ON DELETE CASCADE
);
 
CREATE TABLE ITEM(
  Ino INT ,
  Uprice INT, 
  PRIMARY KEY(Ino)
);
 
CREATE TABLE ORDER_ITEM(
  Iono INT,
  Oino  INT,
  Qty INT, 
  PRIMARY KEY(Iono,Oino),
  Foreign KEY(Iono) REFERENCES ORDER1(Ono) ON DELETE CASCADE, 
  Foreign KEY(Oino) REFERENCES ITEM(Ino) ON DELETE CASCADE
);
 
CREATE TABLE SHIPMENT(
  Sono INT,
  Shipdate DATE,
  PRIMARY KEY(Sono), 
  Foreign KEY(Sono) REFERENCES ORDER1(Ono) ON DELETE CASCADE, 
);

INSERT INTO CUSTOMER VALUES (1,'Archie','Bangalore');
INSERT INTO CUSTOMER VALUES (2,'Veronica','Bangalore');
INSERT INTO CUSTOMER VALUES (3,'Betty','Mysore');
INSERT INTO CUSTOMER VALUES (4,'Jughead','Bangalore');
INSERT INTO CUSTOMER VALUES (5,'Cheryl','Mysore');
INSERT INTO CUSTOMER VALUES (6,'Jason','Mangalore');
 
INSERT INTO ORDER1 VALUES (1, '01-Jun-2016',1,1000);
INSERT INTO ORDER1 VALUES (2, '03-Jun-2016',1,2000);
INSERT INTO ORDER1 VALUES (3, '03-Jun-2016',3,3000);
INSERT INTO ORDER1 VALUES (4, '05-Jun-2016',4,4000);
INSERT INTO ORDER1 VALUES (5, '06-Jun-2017',5,5000);
 
INSERT INTO ITEM VALUES(1,100);
INSERT INTO ITEM VALUES(2,200);
INSERT INTO ITEM VALUES(3,300);
INSERT INTO ITEM VALUES(4,400);
INSERT INTO ITEM VALUES(10,500);
 
INSERT INTO ORDER_ITEM VALUES(1,1,2);
INSERT INTO ORDER_ITEM VALUES(1,2,1);
INSERT INTO ORDER_ITEM VALUES(2,3,2);
INSERT INTO ORDER_ITEM VALUES(3,4,3);
INSERT INTO ORDER_ITEM VALUES(4,3,1);
INSERT INTO ORDER_ITEM VALUES(5,2,1);
 
INSERT INTO SHIPMENT VALUES(1,1,'03-Jun-2016');
INSERT INTO SHIPMENT VALUES(2,1,'03-Jun-2016');
INSERT INTO SHIPMENT VALUES(3,2,'05-Jun-2016');
INSERT INTO SHIPMENT VALUES(4,3,'05-Jun-2016');
INSERT INTO SHIPMENT VALUES(5,4,'06-Jun-2016');

-- List name of customer, no. of orders placed by each customer residing in Bangalore city.

SELECT Cname,count(Ono) FROM CUSTOMER,ORDER1 WHERE Ocno=Cno AND Ccity=’Bangalore’ GROUP BY Cname;

-- List the names of customers who have ordered at least 10 items.

SELECT Cname FROM CUSTOMER,ORDER1 WHERE Ocno=Cno GROUP BY Cname HAVING count(*)>=10;
-- or
SELECT Cname FROM CUSTOMER WHERE Cin IN (SELECT Ocno FROM ORDER1 GROUP BY Ocno HAVING count(*)>=10);

-- List the customer names who have not ordered for item no. 10

SELECT DISTINCT Cname FROM ORDER1,CUSTOMER,ORDER_ITEM WHERE  Ono=Iono AND Ocno=Cno AND Iono!=10;
-- or
SELECT Cname FROM CUSTOMER WHERE Cin IN (SELECT Ocno FROM ORDER1 WHERE Ono IN (SELECT Oino FROM ORDER_ITEM WHERE Iono <> 10));